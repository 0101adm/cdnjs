define(function(e,h,c){var k=e("../tokenizer").Tokenizer;var j=e("./coffee_highlight_rules").CoffeeHighlightRules;var g=e("./matching_brace_outdent").MatchingBraceOutdent;var a=e("./folding/coffee").FoldMode;var d=e("../range").Range;var f=e("./text").Mode;var b=e("../worker/worker_client").WorkerClient;var i=e("../lib/oop");function l(){this.HighlightRules=j;this.$outdent=new g();this.foldingRules=new a()}i.inherits(l,f);(function(){var o=/(?:[({[=:]|[-=]>|\b(?:else|switch|try|catch(?:\s*[$A-Za-z_\x7f-\uffff][$\w\x7f-\uffff]*)?|finally))\s*$/;var p=/^(\s*)#/;var m=/^\s*###(?!#)/;var n=/^\s*/;this.getNextLineIndent=function(t,r,s){var q=this.$getIndent(r);var u=this.getTokenizer().getLineTokens(r,t).tokens;if(!(u.length&&u[u.length-1].type==="comment")&&t==="start"&&o.test(r)){q+=s}return q};this.toggleCommentLines=function(v,w,t,s){console.log("toggle");var r=new d(0,0,0,0);for(var u=t;u<=s;++u){var q=w.getLine(u);if(m.test(q)){continue}if(p.test(q)){q=q.replace(p,"$1")}else{q=q.replace(n,"$&#")}r.end.row=r.start.row=u;r.end.column=q.length+1;w.replace(r,q)}};this.checkOutdent=function(s,q,r){return this.$outdent.checkOutdent(q,r)};this.autoOutdent=function(q,r,s){this.$outdent.autoOutdent(r,s)};this.createWorker=function(q){var r=new b(["ace"],"ace/mode/coffee_worker","Worker");r.attachToDocument(q.getDocument());r.on("error",function(s){q.setAnnotations([s.data])});r.on("ok",function(s){q.clearAnnotations()});return r};this.$id="ace/mode/coffee"}).call(l.prototype);h.Mode=l});