define(function(d,f,b){var h=d("../../lib/oop");var e=d("../behaviour").Behaviour;var j=d("./cstyle").CstyleBehaviour;var a=d("../behaviour/xml").XmlBehaviour;var i=d("../../token_iterator").TokenIterator;function c(l,m){var k=true;var n=l.type.split(".");var o=m.split(".");o.forEach(function(p){if(n.indexOf(p)==-1){k=false;return false}});return k}var g=function(){this.inherit(j,["braces","parens","string_dquotes"]);this.inherit(a);this.add("autoclosing","insertion",function(k,m,r,s,t){if(t==">"){var o=r.getCursorPosition();var n=new i(s,o.row,o.column);var l=n.getCurrentToken();var q=false;var k=JSON.parse(k).pop();if((l&&l.value===">")||k!=="StartTag"){return}if(!l||!c(l,"meta.tag")&&!(c(l,"text")&&l.value.match("/"))){do{l=n.stepBackward()}while(l&&(c(l,"string")||c(l,"keyword.operator")||c(l,"entity.attribute-name")||c(l,"text")))}else{q=true}var p=n.stepBackward();if(!l||!c(l,"meta.tag")||(p!==null&&p.value.match("/"))){return}var u=l.value.substring(1);if(q){var u=u.substring(0,o.column-l.start)}return{text:"></"+u+">",selection:[1,1]}}})};h.inherits(g,e);f.XQueryBehaviour=g});