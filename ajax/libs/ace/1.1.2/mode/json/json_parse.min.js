define(function(f,i,d){var e,b,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},p,n=function(q){throw {name:"SyntaxError",message:q,at:e,text:p}},j=function(q){if(q&&q!==b){n("Expected '"+q+"' instead of '"+b+"'")}b=p.charAt(e);e+=1;return b},h=function(){var r,q="";if(b==="-"){q="-";j("-")}while(b>="0"&&b<="9"){q+=b;j()}if(b==="."){q+=".";while(j()&&b>="0"&&b<="9"){q+=b}}if(b==="e"||b==="E"){q+=b;j();if(b==="-"||b==="+"){q+=b;j()}while(b>="0"&&b<="9"){q+=b;j()}}r=+q;if(isNaN(r)){n("Bad number")}else{return r}},k=function(){var t,s,r="",q;if(b==='"'){while(j()){if(b==='"'){j();return r}else{if(b==="\\"){j();if(b==="u"){q=0;for(s=0;s<4;s+=1){t=parseInt(j(),16);if(!isFinite(t)){break}q=q*16+t}r+=String.fromCharCode(q)}else{if(typeof a[b]==="string"){r+=a[b]}else{break}}}else{r+=b}}}}n("Bad string")},m=function(){while(b&&b<=" "){j()}},c=function(){switch(b){case"t":j("t");j("r");j("u");j("e");return true;case"f":j("f");j("a");j("l");j("s");j("e");return false;case"n":j("n");j("u");j("l");j("l");return null}n("Unexpected '"+b+"'")},o,l=function(){var q=[];if(b==="["){j("[");m();if(b==="]"){j("]");return q}while(b){q.push(o());m();if(b==="]"){j("]");return q}j(",");m()}}n("Bad array")},g=function(){var r,q={};if(b==="{"){j("{");m();if(b==="}"){j("}");return q}while(b){r=k();m();j(":");if(Object.hasOwnProperty.call(q,r)){n('Duplicate key "'+r+'"')}q[r]=o();m();if(b==="}"){j("}");return q}j(",");m()}}n("Bad object")};o=function(){m();switch(b){case"{":return g();case"[":return l();case'"':return k();case"-":return h();default:return b>="0"&&b<="9"?h():c()}};return function(t,r){var q;p=t;e=0;b=" ";q=o();m();if(b){n("Syntax error")}return typeof r==="function"?function s(y,x){var w,u,z=y[x];if(z&&typeof z==="object"){for(w in z){if(Object.hasOwnProperty.call(z,w)){u=s(z,w);if(u!==undefined){z[w]=u}else{delete z[w]}}}}return r.call(y,x,z)}({"":q},""):q}});