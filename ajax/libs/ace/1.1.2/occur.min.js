define(function(e,h,c){var i=e("./lib/oop");var d=e("./range").Range;var f=e("./search").Search;var a=e("./edit_session").EditSession;var j=e("./search_highlight").SearchHighlight;function b(){}i.inherits(b,f);(function(){this.enter=function(m,l){if(!l.needle){return false}var n=m.getCursorPosition();this.displayOccurContent(m,l);var k=this.originalToOccurPosition(m.session,n);m.moveCursorToPosition(k);return true};this.exit=function(m,l){var n=l.translatePosition&&m.getCursorPosition();var k=n&&this.occurToOriginalPosition(m.session,n);this.displayOriginalContent(m);if(k){m.moveCursorToPosition(k)}return true};this.highlight=function(l,m){var k=l.$occurHighlight=l.$occurHighlight||l.addDynamicMarker(new j(null,"ace_occur-highlight","text"));k.setRegexp(m);l._emit("changeBackMarker")};this.displayOccurContent=function(n,m){this.$originalSession=n.session;var o=this.matchingLines(n.session,m);var k=o.map(function(p){return p.content});var l=new a(k.join("\n"));l.$occur=this;l.$occurMatchingLines=o;n.setSession(l);this.highlight(l,m.re);l._emit("changeBackMarker")};this.displayOriginalContent=function(k){k.setSession(this.$originalSession)};this.originalToOccurPosition=function(m,o){var k=m.$occurMatchingLines;var n={row:0,column:0};if(!k){return n}for(var l=0;l<k.length;l++){if(k[l].row===o.row){return{row:l,column:o.column}}}return n};this.occurToOriginalPosition=function(l,m){var k=l.$occurMatchingLines;if(!k||!k[m.row]){return m}return{row:k[m.row].row,column:m.column}};this.matchingLines=function(m,k){k=i.mixin({},k);if(!m||!k.needle){return[]}var l=new f();l.set(k);return l.findAll(m).reduce(function(n,o){var q=o.start.row;var p=n[n.length-1];return p&&p.row===q?n:n.concat({row:q,content:m.getLine(q)})},[])}}).call(b.prototype);var g=e("./lib/dom");g.importCssString(".ace_occur-highlight {\n    border-radius: 4px;\n    background-color: rgba(87, 255, 8, 0.25);\n    position: absolute;\n    z-index: 4;\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    box-shadow: 0 0 4px rgb(91, 255, 50);\n}\n.ace_dark .ace_occur-highlight {\n    background-color: rgb(80, 140, 85);\n    box-shadow: 0 0 4px rgb(60, 120, 70);\n}\n","incremental-occur-highlighting");h.Occur=b});