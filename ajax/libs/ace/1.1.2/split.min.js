define(function(d,f,c){var i=d("./lib/oop");var b=d("./lib/lang");var k=d("./lib/event_emitter").EventEmitter;var h=d("./editor").Editor;var e=d("./virtual_renderer").VirtualRenderer;var a=d("./edit_session").EditSession;var g=function(l,n,m){this.BELOW=1;this.BESIDE=0;this.$container=l;this.$theme=n;this.$splits=0;this.$editorCSS="";this.$editors=[];this.$orientation=this.BESIDE;this.setSplits(m||1);this.$cEditor=this.$editors[0];this.on("focus",function(o){this.$cEditor=o}.bind(this))};(function(){i.implement(this,k);this.$createEditor=function(){var m=document.createElement("div");m.className=this.$editorCSS;m.style.cssText="position: absolute; top:0px; bottom:0px";this.$container.appendChild(m);var l=new h(new e(m,this.$theme));l.on("focus",function(){this._emit("focus",l)}.bind(this));this.$editors.push(l);l.setFontSize(this.$fontSize);return l};this.setSplits=function(m){var l;if(m<1){throw"The number of splits have to be > 0!"}if(m==this.$splits){return}else{if(m>this.$splits){while(this.$splits<this.$editors.length&&this.$splits<m){l=this.$editors[this.$splits];this.$container.appendChild(l.container);l.setFontSize(this.$fontSize);this.$splits++}while(this.$splits<m){this.$createEditor();this.$splits++}}else{while(this.$splits>m){l=this.$editors[this.$splits-1];this.$container.removeChild(l.container);this.$splits--}}}this.resize()};this.getSplits=function(){return this.$splits};this.getEditor=function(l){return this.$editors[l]};this.getCurrentEditor=function(){return this.$cEditor};this.focus=function(){this.$cEditor.focus()};this.blur=function(){this.$cEditor.blur()};this.setTheme=function(l){this.$editors.forEach(function(m){m.setTheme(l)})};this.setKeyboardHandler=function(l){this.$editors.forEach(function(m){m.setKeyboardHandler(l)})};this.forEach=function(m,l){this.$editors.forEach(m,l)};this.$fontSize="";this.setFontSize=function(l){this.$fontSize=l;this.forEach(function(m){m.setFontSize(l)})};this.$cloneSession=function(o){var m=new a(o.getDocument(),o.getMode());var n=o.getUndoManager();if(n){var l=new j(n,m);m.setUndoManager(l)}m.$informUndoManager=b.delayedCall(function(){m.$deltas=[]});m.setTabSize(o.getTabSize());m.setUseSoftTabs(o.getUseSoftTabs());m.setOverwrite(o.getOverwrite());m.setBreakpoints(o.getBreakpoints());m.setUseWrapMode(o.getUseWrapMode());m.setUseWorker(o.getUseWorker());m.setWrapLimitRange(o.$wrapLimitRange.min,o.$wrapLimitRange.max);m.$foldData=o.$cloneFoldData();return m};this.setSession=function(o,l){var m;if(l==null){m=this.$cEditor}else{m=this.$editors[l]}var n=this.$editors.some(function(p){return p.session===o});if(n){o=this.$cloneSession(o)}m.setSession(o);return o};this.getOrientation=function(){return this.$orientation};this.setOrientation=function(l){if(this.$orientation==l){return}this.$orientation=l;this.resize()};this.resize=function(){var p=this.$container.clientWidth;var m=this.$container.clientHeight;var o;if(this.$orientation==this.BESIDE){var q=p/this.$splits;for(var n=0;n<this.$splits;n++){o=this.$editors[n];o.container.style.width=q+"px";o.container.style.top="0px";o.container.style.left=n*q+"px";o.container.style.height=m+"px";o.resize()}}else{var l=m/this.$splits;for(var n=0;n<this.$splits;n++){o=this.$editors[n];o.container.style.width=p+"px";o.container.style.top=n*l+"px";o.container.style.left="0px";o.container.style.height=l+"px";o.resize()}}}}).call(g.prototype);function j(m,l){this.$u=m;this.$doc=l}(function(){this.execute=function(l){this.$u.execute(l)};this.undo=function(){var l=this.$u.undo(true);if(l){this.$doc.selection.setSelectionRange(l)}};this.redo=function(){var l=this.$u.redo(true);if(l){this.$doc.selection.setSelectionRange(l)}};this.reset=function(){this.$u.reset()};this.hasUndo=function(){return this.$u.hasUndo()};this.hasRedo=function(){return this.$u.hasRedo()}}).call(j.prototype);f.Split=g});