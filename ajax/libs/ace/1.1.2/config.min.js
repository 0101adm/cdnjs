define(function(e,h,d){var c=e("./lib/lang");var i=e("./lib/oop");var j=e("./lib/net");var l=e("./lib/event_emitter").EventEmitter;var b=(function(){return this})();var k={packaged:false,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};h.get=function(m){if(!k.hasOwnProperty(m)){throw new Error("Unknown config key: "+m)}return k[m]};h.set=function(m,n){if(!k.hasOwnProperty(m)){throw new Error("Unknown config key: "+m)}k[m]=n};h.all=function(){return c.copyObject(k)};i.implement(h,l);h.moduleUrl=function(o,n){if(k.$moduleUrls[o]){return k.$moduleUrls[o]}var s=o.split("/");n=n||s[s.length-2]||"";var m=n=="snippets"?"/":"-";var q=s[s.length-1];if(m=="-"){var p=new RegExp("^"+n+"[\\-_]|[\\-_]"+n+"$","g");q=q.replace(p,"")}if((!q||q==n)&&s.length>1){q=s[s.length-2]}var r=k[n+"Path"];if(r==null){r=k.basePath}else{if(m=="/"){n=m=""}}if(r&&r.slice(-1)!="/"){r+="/"}return r+n+m+q+this.get("suffix")};h.setModuleUrl=function(m,n){return k.$moduleUrls[m]=n};h.$loading={};h.loadModule=function(m,p){var n,o;if(Array.isArray(m)){o=m[0];m=m[1]}try{n=e(m)}catch(q){}if(n&&!h.$loading[m]){return p&&p(n)}if(!h.$loading[m]){h.$loading[m]=[]}h.$loading[m].push(p);if(h.$loading[m].length>1){return}var r=function(){e([m],function(s){h._emit("load.module",{name:m,module:s});var t=h.$loading[m];h.$loading[m]=null;t.forEach(function(u){u&&u(s)})})};if(!h.get("packaged")){return r()}j.loadScript(h.moduleUrl(m,o),r)};h.init=function(){k.packaged=e.packaged||d.packaged||(b.define&&define.packaged);if(!b.document){return""}var o={};var q="";var s=document.getElementsByTagName("script");for(var v=0;v<s.length;v++){var x=s[v];var n=x.src||x.getAttribute("src");if(!n){continue}var u=x.attributes;for(var t=0,r=u.length;t<r;t++){var w=u[t];if(w.name.indexOf("data-ace-")===0){o[f(w.name.replace(/^data-ace-/,""))]=w.value}}var p=n.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);if(p){q=p[1]}}if(q){o.base=o.base||q;o.packaged=true}o.basePath=o.base;o.workerPath=o.workerPath||o.base;o.modePath=o.modePath||o.base;o.themePath=o.themePath||o.base;delete o.base;for(var y in o){if(typeof o[y]!=="undefined"){h.set(y,o[y])}}};function f(m){return m.replace(/-(.)/g,function(n,o){return o.toUpperCase()})}var a={setOptions:function(m){Object.keys(m).forEach(function(n){this.setOption(n,m[n])},this)},getOptions:function(n){var m={};if(!n){n=Object.keys(this.$options)}else{if(!Array.isArray(n)){m=n;n=Object.keys(m)}}n.forEach(function(o){m[o]=this.getOption(o)},this);return m},setOption:function(m,o){if(this["$"+m]===o){return}var n=this.$options[m];if(!n){if(typeof console!="undefined"&&console.warn){console.warn('misspelled option "'+m+'"')}return undefined}if(n.forwardTo){return this[n.forwardTo]&&this[n.forwardTo].setOption(m,o)}if(!n.handlesSet){this["$"+m]=o}if(n&&n.set){n.set.call(this,o)}},getOption:function(m){var n=this.$options[m];if(!n){if(typeof console!="undefined"&&console.warn){console.warn('misspelled option "'+m+'"')}return undefined}if(n.forwardTo){return this[n.forwardTo]&&this[n.forwardTo].getOption(m)}return n&&n.get?n.get.call(this):this["$"+m]}};var g={};h.defineOptions=function(o,n,m){if(!o.$options){g[n]=o.$options={}}Object.keys(m).forEach(function(q){var p=m[q];if(typeof p=="string"){p={forwardTo:p}}p.name||(p.name=q);o.$options[p.name]=p;if("initialValue" in p){o["$"+p.name]=p.initialValue}});i.implement(o,a);return this};h.resetOptions=function(m){Object.keys(m.$options).forEach(function(o){var n=m.$options[o];if("value" in n){m.setOption(o,n.value)}})};h.setDefaultValue=function(p,m,o){var n=g[p]||(g[p]={});if(n[m]){if(n.forwardTo){h.setDefaultValue(n.forwardTo,m,o)}else{n[m].value=o}}};h.setDefaultValues=function(m,n){Object.keys(n).forEach(function(o){h.setDefaultValue(m,o,n[o])})}});