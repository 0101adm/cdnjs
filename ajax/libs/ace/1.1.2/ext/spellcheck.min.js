define(function(c,b,d){var e=c("../lib/event");b.contextMenuHandler=function(i){var n=i.target;var m=n.textInput.getElement();if(!n.selection.isEmpty()){return}var j=n.getCursorPosition();var f=n.session.getWordRange(j.row,j.column);var l=n.session.getTextRange(f);n.session.tokenRe.lastIndex=0;if(!n.session.tokenRe.test(l)){return}var h="\x01\x01";var k=l+" "+h;m.value=k;m.setSelectionRange(l.length,l.length+1);m.setSelectionRange(0,0);m.setSelectionRange(0,l.length);var o=false;e.addListener(m,"keydown",function g(){e.removeListener(m,"keydown",g);o=true});n.textInput.setInputHandler(function(p){console.log(p,k,m.selectionStart,m.selectionEnd);if(p==k){return""}if(p.lastIndexOf(k,0)===0){return p.slice(k.length)}if(p.substr(m.selectionEnd)==k){return p.slice(0,-k.length)}if(p.slice(-2)==h){var q=p.slice(0,-2);if(q.slice(-1)==" "){if(o){return q.substring(0,m.selectionEnd)}q=q.slice(0,-1);n.session.replace(f,q);return""}}return p})};var a=c("../editor").Editor;c("../config").defineOptions(a.prototype,"editor",{spellcheck:{set:function(g){var f=this.textInput.getElement();f.spellcheck=!!g;if(!g){this.removeListener("nativecontextmenu",b.contextMenuHandler)}else{this.on("nativecontextmenu",b.contextMenuHandler)}},value:true}})});