if(typeof process!=="undefined"){require("amd-loader")}define(function(f,h,d){var a=f("./edit_session").EditSession;var k=f("./editor").Editor;var j=f("./test/mockrenderer").MockRenderer;var e=f("./range").Range;var b=f("./test/assertions");var c=f("./occur").Occur;var l=f("./commands/occur_commands").occurStartCommand;var i,g;d.exports={name:"ACE occur.js",setUp:function(){var m=new a("");i=new k(new j(),m);g=new c()},"test: find lines matching":function(){i.session.insert({row:0,column:0},"abc\ndef\nxyz\nbcxbc");var m=g.matchingLines(i.session,{needle:"bc"}),n=[{row:0,content:"abc"},{row:3,content:"bcxbc"}];b.deepEqual(m,n)},"test: display occurrences":function(){var m="abc\ndef\nxyz\nbcx\n";i.session.insert({row:0,column:0},m);g.displayOccurContent(i,{needle:"bc"});b.equal(i.getValue(),"abc\nbcx");g.displayOriginalContent(i);b.equal(i.getValue(),m)},"test: original position from occur doc":function(){var m="abc\ndef\nxyz\nbcx\n";i.session.insert({row:0,column:0},m);g.displayOccurContent(i,{needle:"bc"});b.equal(i.getValue(),"abc\nbcx");var n=g.occurToOriginalPosition(i.session,{row:1,column:2});b.position(n,3,2)},"test: occur command":function(){var m="hel\nlo\n\nwo\nrld\n";i.session.insert({row:0,column:0},m);i.commands.addCommand(l);i.execCommand("occur",{needle:"o"});b.equal(i.getValue(),"lo\nwo");b.ok(i.getKeyboardHandler().isOccurHandler,"no occur handler installed");b.ok(i.commands.byName.occurexit,"no exitoccur command installed");i.execCommand("occurexit");b.equal(i.getValue(),m);b.ok(!i.getKeyboardHandler().isOccurHandler,"occur handler installed after detach");b.ok(!i.commands.byName.occurexit,"exitoccur installed after exiting occur")},"test: occur navigation":function(){var m="hel\nlo\n\nwo\nrld\n";i.session.insert({row:0,column:0},m);i.commands.addCommand(l);i.moveCursorToPosition({row:1,column:1});i.execCommand("occur",{needle:"o"});b.equal(i.getValue(),"lo\nwo");b.position(i.getCursorPosition(),0,1,"original -> occur pos");i.moveCursorToPosition({row:1,column:1});i.execCommand("occuraccept");b.position(i.getCursorPosition(),3,1,"occur -> original pos")},"test: recursive occur":function(){var m="x\nabc1\nx\nabc2\n";i.session.insert({row:0,column:0},m);i.commands.addCommand(l);i.execCommand("occur",{needle:"abc"});b.equal(i.getValue(),"abc1\nabc2","orig -> occur1");i.execCommand("occur",{needle:"2"});b.equal(i.getValue(),"abc2","occur1 -> occur2");i.execCommand("occurexit");b.equal(i.getValue(),"abc1\nabc2","occur2 -> occur1");i.execCommand("occurexit");b.equal(i.getValue(),m,"occur1 -> orig")}}});if(typeof module!=="undefined"&&module===require.main){require("asyncjs").test.testcase(module.exports).exec()};