define(function(c,a,d){var b=c("../config");var h=c("../lib/oop");var g=c("../keyboard/hash_handler").HashHandler;var f=c("./occur_commands").occurStartCommand;a.iSearchStartCommands=[{name:"iSearch",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(j,i){b.loadModule(["core","ace/incremental_search"],function(l){var k=l.iSearch=l.iSearch||new l.IncrementalSearch();k.activate(j,i.backwards);if(i.jumpToFirstMatch){k.next(i)}})},readOnly:true},{name:"iSearchBackwards",exec:function(i,j){i.execCommand("iSearch",{backwards:true})},readOnly:true},{name:"iSearchAndGo",bindKey:{win:"Ctrl-K",mac:"Command-G"},exec:function(i,j){i.execCommand("iSearch",{jumpToFirstMatch:true,useCurrentOrPrevSearch:true})},readOnly:true},{name:"iSearchBackwardsAndGo",bindKey:{win:"Ctrl-Shift-K",mac:"Command-Shift-G"},exec:function(i){i.execCommand("iSearch",{jumpToFirstMatch:true,backwards:true,useCurrentOrPrevSearch:true})},readOnly:true}];a.iSearchCommands=[{name:"restartSearch",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(i){i.cancelSearch(true)},readOnly:true,isIncrementalSearchCommand:true},{name:"searchForward",bindKey:{win:"Ctrl-S|Ctrl-K",mac:"Ctrl-S|Command-G"},exec:function(i,j){j.useCurrentOrPrevSearch=true;i.next(j)},readOnly:true,isIncrementalSearchCommand:true},{name:"searchBackward",bindKey:{win:"Ctrl-R|Ctrl-Shift-K",mac:"Ctrl-R|Command-Shift-G"},exec:function(i,j){j.useCurrentOrPrevSearch=true;j.backwards=true;i.next(j)},readOnly:true,isIncrementalSearchCommand:true},{name:"extendSearchTerm",exec:function(i,j){i.addChar(j)},readOnly:true,isIncrementalSearchCommand:true},{name:"extendSearchTermSpace",bindKey:"space",exec:function(i){i.addChar(" ")},readOnly:true,isIncrementalSearchCommand:true},{name:"shrinkSearchTerm",bindKey:"backspace",exec:function(i){i.removeChar()},readOnly:true,isIncrementalSearchCommand:true},{name:"confirmSearch",bindKey:"return",exec:function(i){i.deactivate()},readOnly:true,isIncrementalSearchCommand:true},{name:"cancelSearch",bindKey:"esc|Ctrl-G",exec:function(i){i.deactivate(true)},readOnly:true,isIncrementalSearchCommand:true},{name:"occurisearch",bindKey:"Ctrl-O",exec:function(i){var j=h.mixin({},i.$options);i.deactivate();f.exec(i.$editor,j)},readOnly:true,isIncrementalSearchCommand:true}];function e(i){this.$iSearch=i}h.inherits(e,g);(function(){this.attach=function(k){var j=this.$iSearch;g.call(this,a.iSearchCommands,k.commands.platform);this.$commandExecHandler=k.commands.addEventListener("exec",function(l){if(!l.command.isIncrementalSearchCommand){return undefined}l.stopPropagation();l.preventDefault();return l.command.exec(j,l.args||{})})};this.detach=function(j){if(!this.$commandExecHandler){return}j.commands.removeEventListener("exec",this.$commandExecHandler);delete this.$commandExecHandler};var i=this.handleKeyboard;this.handleKeyboard=function(n,l,k,o){var m=i.call(this,n,l,k,o);if(m.command){return m}if(l==-1){var j=this.commands.extendSearchTerm;if(j){return{command:j,args:k}}}return{command:"null",passEvent:l==0||l==4}}}).call(e.prototype);a.IncrementalSearchKeyboardHandler=e});