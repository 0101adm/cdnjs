if(typeof process!=="undefined"){require("amd-loader")}define(function(d,b,f){var e=d("./edit_session").EditSession;var c=d("./search").Search;var a=d("./test/assertions");f.exports={"test: configure the search object":function(){var g=new c();g.set({needle:"juhu"})},"test: find simple text in document":function(){var i=new e(["juhu kinners 123","456"]);var h=new c().set({needle:"kinners"});var g=h.find(i);a.position(g.start,0,5);a.position(g.end,0,12)},"test: find simple text in next line":function(){var i=new e(["abc","juhu kinners 123","456"]);var h=new c().set({needle:"kinners"});var g=h.find(i);a.position(g.start,1,5);a.position(g.end,1,12)},"test: find text starting at cursor position":function(){var i=new e(["juhu kinners","juhu kinners 123"]);i.getSelection().moveCursorTo(0,6);var h=new c().set({needle:"kinners"});var g=h.find(i);a.position(g.start,1,5);a.position(g.end,1,12)},"test: wrap search is on by default":function(){var h=new e(["abc","juhu kinners 123","456"]);h.getSelection().moveCursorTo(2,1);var g=new c().set({needle:"kinners"});a.notEqual(g.find(h),null)},"test: wrap search should wrap at file end":function(){var i=new e(["abc","juhu kinners 123","456"]);i.getSelection().moveCursorTo(2,1);var h=new c().set({needle:"kinners",wrap:true});var g=h.find(i);a.position(g.start,1,5);a.position(g.end,1,12)},"test: wrap search should find needle even if it starts inside it":function(){var i=new e(["abc","juhu kinners 123","456"]);i.getSelection().moveCursorTo(6,1);var h=new c().set({needle:"kinners",wrap:true});var g=h.find(i);a.position(g.start,1,5);a.position(g.end,1,12)},"test: wrap search with no match should return 'null'":function(){var h=new e(["abc","juhu kinners 123","456"]);h.getSelection().moveCursorTo(2,1);var g=new c().set({needle:"xyz",wrap:true});a.equal(g.find(h),null)},"test: case sensitive is by default off":function(){var h=new e(["abc","juhu kinners 123","456"]);var g=new c().set({needle:"JUHU"});a.range(g.find(h),1,0,1,4)},"test: case sensitive search":function(){var i=new e(["abc","juhu kinners 123","456"]);var h=new c().set({needle:"KINNERS",caseSensitive:true});var g=h.find(i);a.equal(g,null)},"test: whole word search should not match inside of words":function(){var i=new e(["juhukinners","juhu kinners 123","456"]);var h=new c().set({needle:"kinners",wholeWord:true});var g=h.find(i);a.position(g.start,1,5);a.position(g.end,1,12)},"test: find backwards":function(){var i=new e(["juhu juhu juhu juhu"]);i.getSelection().moveCursorTo(0,10);var h=new c().set({needle:"juhu",backwards:true});var g=h.find(i);a.position(g.start,0,5);a.position(g.end,0,9)},"test: find in selection":function(){var i=new e(["juhu","juhu","juhu","juhu"]);i.getSelection().setSelectionAnchor(1,0);i.getSelection().selectTo(3,5);var h=new c().set({needle:"juhu",wrap:true,range:i.getSelection().getRange()});var g=h.find(i);a.position(g.start,1,0);a.position(g.end,1,4);h=new c().set({needle:"juhu",wrap:true,range:i.getSelection().getRange()});i.getSelection().setSelectionAnchor(0,2);i.getSelection().selectTo(3,2);var g=h.find(i);a.position(g.start,1,0);a.position(g.end,1,4)},"test: find backwards in selection":function(){var i=new e(["juhu","juhu","juhu","juhu"]);i.getSelection().setSelectionAnchor(0,2);i.getSelection().selectTo(3,2);var h=new c().set({needle:"juhu",wrap:true,backwards:true,range:i.getSelection().getRange()});var g=h.find(i);a.position(g.start,2,0);a.position(g.end,2,4);h=new c().set({needle:"juhu",wrap:true,range:i.getSelection().getRange()});i.getSelection().setSelectionAnchor(0,2);i.getSelection().selectTo(1,2);var g=h.find(i);a.position(g.start,1,0);a.position(g.end,1,4)},"test: edge case - match directly before the cursor":function(){var i=new e(["123","123","juhu"]);var h=new c().set({needle:"juhu",wrap:true});i.getSelection().moveCursorTo(2,5);var g=h.find(i);a.position(g.start,2,0);a.position(g.end,2,4)},"test: edge case - match backwards directly after the cursor":function(){var i=new e(["123","123","juhu"]);var h=new c().set({needle:"juhu",wrap:true,backwards:true});i.getSelection().moveCursorTo(2,0);var g=h.find(i);a.position(g.start,2,0);a.position(g.end,2,4)},"test: find using a regular expression":function(){var i=new e(["abc123 123 cd","abc"]);var h=new c().set({needle:"\\d+",regExp:true});var g=h.find(i);a.position(g.start,0,3);a.position(g.end,0,6)},"test: find using a regular expression and whole word":function(){var i=new e(["abc123 123 cd","abc"]);var h=new c().set({needle:"\\d+\\b",regExp:true,wholeWord:true});var g=h.find(i);a.position(g.start,0,7);a.position(g.end,0,10)},"test: use regular expressions with capture groups":function(){var i=new e(["  ab: 12px","  <h1 abc"]);var h=new c().set({needle:"(\\d+)",regExp:true});var g=h.find(i);a.position(g.start,0,6);a.position(g.end,0,8)},"test: find all matches in selection":function(){var i=new e(["juhu","juhu","juhu","juhu"]);i.getSelection().setSelectionAnchor(0,2);i.getSelection().selectTo(3,2);var h=new c().set({needle:"uh",wrap:true,range:i.getSelection().getRange()});var g=h.findAll(i);a.equal(g.length,2);a.position(g[0].start,1,1);a.position(g[0].end,1,3);a.position(g[1].start,2,1);a.position(g[1].end,2,3)},"test: find all multiline matches":function(){var i=new e(["juhu","juhu","juhu","juhu"]);var h=new c().set({needle:"hu\nju",wrap:true});var g=h.findAll(i);a.equal(g.length,3);a.position(g[0].start,0,2);a.position(g[0].end,1,2);a.position(g[1].start,1,2);a.position(g[1].end,2,2)},"test: replace() should return the replacement if the input matches the needle":function(){var g=new c().set({needle:"juhu"});a.equal(g.replace("juhu","kinners"),"kinners");a.equal(g.replace("","kinners"),null);a.equal(g.replace(" juhu","kinners"),null);a.equal(g.replace("Juhu","kinners"),"kinners");g.set({caseSensitive:true});a.equal(g.replace("Juhu","kinners"),null)},"test: replace with a RegExp search":function(){var g=new c().set({needle:"\\d+",regExp:true});a.equal(g.replace("123","kinners"),"kinners");a.equal(g.replace("01234","kinners"),"kinners");a.equal(g.replace("","kinners"),null);a.equal(g.replace("a12","kinners"),null);a.equal(g.replace("12a","kinners"),null)},"test: replace with RegExp match and capture groups":function(){var g=new c().set({needle:"ab(\\d\\d)",regExp:true});a.equal(g.replace("ab12","cd$1"),"cd12");a.equal(g.replace("ab12","-$&-"),"-ab12-");a.equal(g.replace("ab12","$$"),"$")},"test: find all using regular expresion containing $":function(){var i=new e(["a","     b","c ","d"]);var h=new c().set({needle:"[ ]+$",regExp:true,wrap:true});i.getSelection().moveCursorTo(1,2);var g=h.findAll(i);a.equal(g.length,1);a.position(g[0].start,2,1);a.position(g[0].end,2,2)},"test: find all matches in a line":function(){var i=new e("foo bar foo baz foobar foo");var h=new c().set({needle:"foo",wrap:true,wholeWord:true});i.getSelection().moveCursorTo(0,4);var g=h.findAll(i);a.equal(g.length,3);a.position(g[0].start,0,0);a.position(g[0].end,0,3);a.position(g[1].start,0,8);a.position(g[1].end,0,11);a.position(g[2].start,0,23);a.position(g[2].end,0,26)},"test: find all matches in a line backwards":function(){var i=new e("foo bar foo baz foobar foo");var h=new c().set({needle:"foo",wrap:true,wholeWord:true,backwards:true});i.getSelection().moveCursorTo(0,13);var g=h.findAll(i);a.equal(g.length,3);a.position(g[2].start,0,23);a.position(g[2].end,0,26);a.position(g[1].start,0,8);a.position(g[1].end,0,11);a.position(g[0].start,0,0);a.position(g[0].end,0,3)}}});if(typeof module!=="undefined"&&module===require.main){require("asyncjs").test.testcase(module.exports).exec()};