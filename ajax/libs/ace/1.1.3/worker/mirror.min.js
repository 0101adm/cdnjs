define(function(c,b,d){var a=c("../document").Document;var f=c("../lib/lang");var e=b.Mirror=function(h){this.sender=h;var j=this.doc=new a("");var i=this.deferredUpdate=f.delayedCall(this.onUpdate.bind(this));var g=this;h.on("change",function(k){j.applyDeltas(k.data);if(g.$timeout){return i.schedule(g.$timeout)}g.onUpdate()})};(function(){this.$timeout=500;this.setTimeout=function(g){this.$timeout=g};this.setValue=function(g){this.doc.setValue(g);this.deferredUpdate.schedule(this.$timeout)};this.getValue=function(g){this.sender.callback(this.doc.getValue(),g)};this.onUpdate=function(){};this.isPending=function(){return this.deferredUpdate.isPending()}}).call(e.prototype)});