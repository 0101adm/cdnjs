define(function(d,f,b){var g=d("../lib/oop");var e=d("./text").Mode;var h=d("../tokenizer").Tokenizer;var j=d("./ruby_highlight_rules").RubyHighlightRules;var k=d("./matching_brace_outdent").MatchingBraceOutdent;var c=d("../range").Range;var a=d("./folding/coffee").FoldMode;var i=function(){this.HighlightRules=j;this.$outdent=new k();this.foldingRules=new a()};g.inherits(i,e);(function(){this.lineCommentStart="#";this.getNextLineIndent=function(l,u,m){var n=this.$getIndent(u);var r=this.getTokenizer().getLineTokens(u,l);var s=r.tokens;if(s.length&&s[s.length-1].type=="comment"){return n}if(l=="start"){var q=u.match(/^.*[\{\(\[]\s*$/);var t=u.match(/^\s*(class|def|module)\s.*$/);var p=u.match(/.*do(\s*|\s+\|.*\|\s*)$/);var o=u.match(/^\s*(if|else)\s*/);if(q||t||p||o){n+=m}}return n};this.checkOutdent=function(n,l,m){return/^\s+end$/.test(l+m)||/^\s+}$/.test(l+m)||/^\s+else$/.test(l+m)};this.autoOutdent=function(n,o,p){var l=this.$getIndent(o.getLine(p));var m=o.getTabString();if(l.slice(-m.length)==m){o.remove(new c(p,l.length-m.length,p,l.length))}};this.$id="ace/mode/ruby"}).call(i.prototype);f.Mode=i});