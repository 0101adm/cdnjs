define(function(g,j,f){var m=g("../lib/oop");var e=g("../lib/lang");var c=g("./text_highlight_rules").TextHighlightRules;var l=g("./javascript_highlight_rules").JavaScriptHighlightRules;var d=g("./xml_highlight_rules").XmlHighlightRules;var i=g("./html_highlight_rules").HtmlHighlightRules;var k=g("./css_highlight_rules").CssHighlightRules;var a=function(n){return"(?:[^"+e.escapeRegExp(n)+"\\\\]|\\\\.)*"};function b(n,o){return{token:"support.function",regex:"^```"+n+"\\s*$",push:o+"start"}}var h=function(){i.call(this);this.$rules.start.unshift({token:"empty_line",regex:"^$",next:"allowBlock"},{token:"markup.heading.1",regex:"^=+(?=\\s*$)"},{token:"markup.heading.2",regex:"^\\-+(?=\\s*$)"},{token:function(n){return"markup.heading."+n.length},regex:/^#{1,6}(?=\s*[^ #]|\s+#.)/,next:"header"},b("(?:javascript|js)","jscode-"),b("xml","xmlcode-"),b("html","htmlcode-"),b("css","csscode-"),{token:"support.function",regex:"^```\\s*\\S*(?:{.*?\\})?\\s*$",next:"githubblock"},{token:"string.blockquote",regex:"^\\s*>\\s*(?:[*+-]|\\d+\\.)?\\s+",next:"blockquote"},{token:"constant",regex:"^ {0,2}(?:(?: ?\\* ?){3,}|(?: ?\\- ?){3,}|(?: ?\\_ ?){3,})\\s*$",next:"allowBlock"},{token:"markup.list",regex:"^\\s{0,3}(?:[*+-]|\\d+\\.)\\s+",next:"listblock-start"},{include:"basic"});this.addRules({basic:[{token:"constant.language.escape",regex:/\\[\\`*_{}\[\]()#+\-.!]/},{token:"support.function",regex:"(`+)(.*?[^`])(\\1)"},{token:["text","constant","text","url","string","text"],regex:'^([ ]{0,3}\\[)([^\\]]+)(\\]:\\s*)([^ ]+)(\\s*(?:["][^"]+["])?(\\s*))$'},{token:["text","string","text","constant","text"],regex:"(\\[)("+a("]")+")(\\]s*\\[)("+a("]")+")(\\])"},{token:["text","string","text","markup.underline","string","text"],regex:"(\\[)("+a("]")+')(\\]\\()((?:[^\\)\\s\\\\]|\\\\.|\\s(?=[^"]))*)(\\s*"'+a('"')+'"\\s*)?(\\))'},{token:"string.strong",regex:"([*]{2}|[_]{2}(?=\\S))(.*?\\S[*_]*)(\\1)"},{token:"string.emphasis",regex:"([*]|[_](?=\\S))(.*?\\S[*_]*)(\\1)"},{token:["text","url","text"],regex:"(<)((?:https?|ftp|dict):[^'\">\\s]+|(?:mailto:)?[-.\\w]+\\@[-a-z0-9]+(?:\\.[-a-z0-9]+)*\\.[a-z]+)(>)"}],allowBlock:[{token:"support.function",regex:"^ {4}.+",next:"allowBlock"},{token:"empty",regex:"",next:"start"}],header:[{regex:"$",next:"start"},{include:"basic"},{defaultToken:"heading"}],"listblock-start":[{token:"support.variable",regex:/(?:\[[ x]\])?/,next:"listblock"}],listblock:[{token:"empty_line",regex:"^$",next:"start"},{token:"markup.list",regex:"^\\s{0,3}(?:[*+-]|\\d+\\.)\\s+",next:"listblock-start"},{include:"basic",noEscape:true},{defaultToken:"list"}],blockquote:[{token:"empty_line",regex:"^\\s*$",next:"start"},{token:"string.blockquote",regex:"^\\s*>\\s*(?:[*+-]|\\d+\\.)?\\s+",next:"blockquote"},{include:"basic",noEscape:true},{defaultToken:"string.blockquote"}],githubblock:[{token:"support.function",regex:"^```",next:"start"},{token:"support.function",regex:".+"}]});this.embedRules(l,"jscode-",[{token:"support.function",regex:"^```",next:"pop"}]);this.embedRules(i,"htmlcode-",[{token:"support.function",regex:"^```",next:"pop"}]);this.embedRules(k,"csscode-",[{token:"support.function",regex:"^```",next:"pop"}]);this.embedRules(d,"xmlcode-",[{token:"support.function",regex:"^```",next:"pop"}]);this.normalizeRules()};m.inherits(h,c);j.MarkdownHighlightRules=h});