define(function(d,f,c){var h=d("../lib/oop");var b=d("../lib/lang");var a=d("../worker/mirror").Mirror;var e=d("./html/saxparser").SAXParser;var i={"expected-doctype-but-got-start-tag":"info","expected-doctype-but-got-chars":"info","non-html-root":"info",};var g=f.Worker=function(j){a.call(this,j);this.setTimeout(400);this.context=null};h.inherits(g,a);(function(){this.setOptions=function(j){this.context=j.context};this.onUpdate=function(){var k=this.doc.getValue();if(!k){return}var m=new e();var l=[];var j=function(){};m.contentHandler={startDocument:j,endDocument:j,startElement:j,endElement:j,characters:j};m.errorHandler={error:function(p,n,o){l.push({row:n.line,column:n.column,text:p,type:i[o]||"error"})}};if(this.context){m.parseFragment(k,this.context)}else{m.parse(k)}this.sender.emit("error",l)}}).call(g.prototype)});