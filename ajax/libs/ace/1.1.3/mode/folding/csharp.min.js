define(function(b,a,d){var e=b("../../lib/oop");var g=b("../../range").Range;var c=b("./cstyle").FoldMode;var f=a.FoldMode=function(h){if(h){this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+h.start));this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+h.end))}};e.inherits(f,c);(function(){this.usingRe=/^\s*using \S/;this.getFoldWidgetRangeBase=this.getFoldWidgetRange;this.getFoldWidgetBase=this.getFoldWidget;this.getFoldWidget=function(n,m,o){var l=this.getFoldWidgetBase(n,m,o);if(!l){var h=n.getLine(o);if(/^\s*#region\b/.test(h)){return"start"}var i=this.usingRe;if(i.test(h)){var k=n.getLine(o-1);var j=n.getLine(o+1);if(!i.test(k)&&i.test(j)){return"start"}}}return l};this.getFoldWidgetRange=function(k,j,l){var i=this.getFoldWidgetRangeBase(k,j,l);if(i){return i}var h=k.getLine(l);if(this.usingRe.test(h)){return this.getUsingStatementBlock(k,h,l)}if(/^\s*#region\b/.test(h)){return this.getRegionBlock(k,h,l)}};this.getUsingStatementBlock=function(l,h,m){var k=h.match(this.usingRe)[0].length-1;var o=l.getLength();var j=m;var i=m;while(++m<o){h=l.getLine(m);if(/^\s*$/.test(h)){continue}if(!this.usingRe.test(h)){break}i=m}if(i>j){var n=l.getLine(i).length;return new g(j,k,i,n)}};this.getRegionBlock=function(n,s,r){var i=s.search(/\s*$/);var o=n.getLength();var p=r;var q=/^\s*#(end)?region\b/;var k=1;while(++r<o){s=n.getLine(r);var h=q.exec(s);if(!h){continue}if(h[1]){k--}else{k++}if(!k){break}}var j=r;if(j>p){var l=s.search(/\S/);return new g(p,i,j,l)}}}).call(f.prototype)});