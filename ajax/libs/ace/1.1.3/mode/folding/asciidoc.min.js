define(function(b,a,c){var d=b("../../lib/oop");var g=b("./fold_mode").FoldMode;var f=b("../../range").Range;var e=a.FoldMode=function(){};d.inherits(e,g);(function(){this.foldingStartMarker=/^(?:\|={10,}|[\.\/=\-~^+]{4,}\s*$|={1,5} )/;this.singleLineHeadingRe=/^={1,5}(?=\s+\S)/;this.getFoldWidget=function(j,i,k){var h=j.getLine(k);if(!this.foldingStartMarker.test(h)){return""}if(h[0]=="="){if(this.singleLineHeadingRe.test(h)){return"start"}if(j.getLine(k-1).length!=j.getLine(k).length){return""}return"start"}if(j.bgTokenizer.getState(k)=="dissallowDelimitedBlock"){return"end"}return"start"};this.getFoldWidgetRange=function(j,z,p){var t=j.getLine(p);var m=t.length;var x=j.getLength();var h=p;var y=p;if(!t.match(this.foldingStartMarker)){return}var r;function l(A){r=j.getTokens(A)[0];return r&&r.type}var q=["=","-","~","^","+"];var n="markup.heading";var s=this.singleLineHeadingRe;function v(){var A=r.value.match(s);if(A){return A[0].length}var B=q.indexOf(r.value[0])+1;if(B==1){if(j.getLine(p-1).length!=j.getLine(p).length){return Infinity}}return B}if(l(p)==n){var u=v();while(++p<x){if(l(p)!=n){continue}var i=v();if(i<=u){break}}var w=r&&r.value.match(this.singleLineHeadingRe);y=w?p-1:p-2;if(y>h){while(y>h&&(!l(y)||r.value[0]=="[")){y--}}if(y>h){var k=j.getLine(y).length;return new f(h,m,y,k)}}else{var o=j.bgTokenizer.getState(p);if(o=="dissallowDelimitedBlock"){while(p-->0){if(j.bgTokenizer.getState(p).lastIndexOf("Block")==-1){break}}y=p+1;if(y<h){var k=j.getLine(p).length;return new f(y,5,h,m-5)}}else{while(++p<x){if(j.bgTokenizer.getState(p)=="dissallowDelimitedBlock"){break}}y=p;if(y>h){var k=j.getLine(p).length;return new f(h,5,y,k-5)}}}}}).call(e.prototype)});