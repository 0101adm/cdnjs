define(function(d,e,c){var i,h,a,j,b,g,f;e.starts=function(k,l,m){return l===k.substr(m,l.length)};e.ends=function(m,n,l){var k;k=n.length;return n===m.substr(m.length-k-(l||0),k)};e.repeat=b=function(l,m){var k;k="";while(m>0){if(m&1){k+=l}m>>>=1;l+=l}return k};e.compact=function(o){var m,n,l,k;k=[];for(n=0,l=o.length;n<l;n++){m=o[n];if(m){k.push(m)}}return k};e.count=function(l,m){var k,n;k=n=0;if(!m.length){return 1/0}while(n=1+l.indexOf(m,n)){k++}return k};e.merge=function(k,l){return h(h({},k),l)};h=e.extend=function(k,m){var l,n;for(l in m){n=m[l];k[l]=n}return k};e.flatten=a=function(o){var l,m,n,k;m=[];for(n=0,k=o.length;n<k;n++){l=o[n];if(l instanceof Array){m=m.concat(a(l))}else{m.push(l)}}return m};e.del=function(l,k){var m;m=l[k];delete l[k];return m};e.last=j=function(l,k){return l[l.length-(k||0)-1]};e.some=(f=Array.prototype.some)!=null?f:function(l){var n,m,k;for(m=0,k=this.length;m<k;m++){n=this[m];if(l(n)){return true}}return false};e.invertLiterate=function(n){var l,k,m;m=true;k=(function(){var r,q,o,p;o=n.split("\n");p=[];for(r=0,q=o.length;r<q;r++){l=o[r];if(m&&/^([ ]{4}|[ ]{0,3}\t)/.test(l)){p.push(l)}else{if(m=/^\s*$/.test(l)){p.push(l)}else{p.push("# "+l)}}}return p})();return k.join("\n")};i=function(l,k){if(!k){return l}else{return{first_line:l.first_line,first_column:l.first_column,last_line:k.last_line,last_column:k.last_column}}};e.addLocationDataFn=function(l,k){return function(m){if(((typeof m)==="object")&&(!!m.updateLocationDataIfMissing)){m.updateLocationDataIfMissing(i(l,k))}return m}};e.locationDataToString=function(l){var k;if(("2" in l)&&("first_line" in l[2])){k=l[2]}else{if("first_line" in l){k=l}}if(k){return(""+(k.first_line+1)+":"+(k.first_column+1)+"-")+(""+(k.last_line+1)+":"+(k.last_column+1))}else{return"No location data"}};e.baseFileName=function(l,m,k){var n,o;if(m==null){m=false}if(k==null){k=false}o=k?/\\|\//:/\//;n=l.split(o);l=n[n.length-1];if(!(m&&l.indexOf(".")>=0)){return l}n=l.split(".");n.pop();if(n[n.length-1]==="coffee"&&n.length>1){n.pop()}return n.join(".")};e.isCoffee=function(k){return/\.((lit)?coffee|coffee\.md)$/.test(k)};e.isLiterate=function(k){return/\.(litcoffee|coffee\.md)$/.test(k)};e.throwSyntaxError=function(m,k){var l;if(k.last_line==null){k.last_line=k.first_line}if(k.last_column==null){k.last_column=k.first_column}l=new SyntaxError(m);l.location=k;l.toString=g;l.stack=l.toString();throw l};e.updateSyntaxError=function(l,m,k){if(l.toString===g){l.code||(l.code=m);l.filename||(l.filename=k);l.stack=l.toString()}return l};g=function(){var v,m,s,r,k,p,u,n,w,t,l,q,o;if(!(this.code&&this.location)){return Error.prototype.toString.call(this)}q=this.location,u=q.first_line,p=q.first_column,w=q.last_line,n=q.last_column;if(w==null){w=u}if(n==null){n=p}k=this.filename||"[stdin]";v=this.code.split("\n")[u];l=p;r=u===w?n+1:v.length;t=b(" ",l)+b("^",r-l);if(typeof process!=="undefined"&&process!==null){s=process.stdout.isTTY&&!process.env.NODE_DISABLE_COLORS}if((o=this.colorful)!=null?o:s){m=function(x){return"\x1B[1;31m"+x+"\x1B[0m"};v=v.slice(0,l)+m(v.slice(l,r))+v.slice(r);t=m(t)}return""+k+":"+(u+1)+":"+(p+1)+": error: "+this.message+"\n"+v+"\n"+t}});