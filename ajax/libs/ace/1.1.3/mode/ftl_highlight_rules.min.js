define(function(e,c,f){var g=e("../lib/oop");var h=e("./html_highlight_rules").HtmlHighlightRules;var b=e("./text_highlight_rules").TextHighlightRules;var d=function(){var j="\\?|substring|cap_first|uncap_first|capitalize|chop_linebreak|date|time|datetime|ends_with|html|groups|index_of|j_string|js_string|json_string|last_index_of|length|lower_case|left_pad|right_pad|contains|matches|number|replace|rtf|url|split|starts_with|string|trim|upper_case|word_list|xhtml|xml";var o="c|round|floor|ceiling";var l="iso_[a-z_]+";var t="first|last|seq_contains|seq_index_of|seq_last_index_of|reverse|size|sort|sort_by|chunk";var r="keys|values";var u="children|parent|root|ancestors|node_name|node_type|node_namespace";var p="byte|double|float|int|long|short|number_to_date|number_to_time|number_to_datetime|eval|has_content|interpret|is_[a-z_]+|namespacenew";var q=j+o+l+t+r+u+p;var k="default|exists|if_exists|web_safe";var s="data_model|error|globals|lang|locale|locals|main|namespace|node|current_node|now|output_encoding|template_name|url_escaping_charset|vars|version";var n="gt|gte|lt|lte|as|in|using";var i="true|false";var m="encoding|parse|locale|number_format|date_format|time_format|datetime_format|time_zone|url_escaping_charset|classic_compatible|strip_whitespace|strip_text|strict_syntax|ns_prefixes|attributes";this.$rules={start:[{token:"constant.character.entity",regex:/&[^;]+;/},{token:"support.function",regex:"\\?("+q+")"},{token:"support.function.deprecated",regex:"\\?("+k+")"},{token:"language.variable",regex:"\\.(?:"+s+")"},{token:"constant.language",regex:"\\b("+i+")\\b"},{token:"keyword.operator",regex:"\\b(?:"+n+")\\b"},{token:"entity.other.attribute-name",regex:m},{token:"string",regex:/['"]/,next:"qstring"},{token:function(v){if(v.match("^[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?$")){return"constant.numeric"}else{return"variable"}},regex:/[\w.+\-]+/},{token:"keyword.operator",regex:"!|\\.|\\$|%|&|\\*|\\-\\-|\\-|\\+\\+|\\+|~|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|&&|\\|\\||\\?\\:|\\*=|%=|\\+=|\\-=|&=|\\^="},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],qstring:[{token:"constant.character.escape",regex:'\\\\[nrtvef\\\\"$]'},{token:"string",regex:/['"]/,next:"start"},{defaultToken:"string"}]}};g.inherits(d,b);var a=function(){h.call(this);var l="assign|attempt|break|case|compress|default|elseif|else|escape|fallback|function|flush|ftl|global|if|import|include|list|local|lt|macro|nested|noescape|noparse|nt|recover|recurse|return|rt|setting|stop|switch|t|visit";var k=[{token:"comment",regex:"<#--",next:"ftl-dcomment"},{token:"string.interpolated",regex:"\\${",push:"ftl-start"},{token:"keyword.function",regex:"</?#("+l+")",push:"ftl-start"},{token:"keyword.other",regex:"</?@[a-zA-Z\\.]+",push:"ftl-start"}];var i=[{token:"keyword",regex:"/?>",next:"pop"},{token:"string.interpolated",regex:"}",next:"pop"}];for(var j in this.$rules){this.$rules[j].unshift.apply(this.$rules[j],k)}this.embedRules(d,"ftl-",i,["start"]);this.addRules({"ftl-dcomment":[{token:"comment",regex:".*?-->",next:"pop"},{token:"comment",regex:".+"}]});this.normalizeRules()};g.inherits(a,h);c.FtlHighlightRules=a});