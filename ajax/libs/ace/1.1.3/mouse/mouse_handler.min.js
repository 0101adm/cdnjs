define(function(f,h,c){var a=f("../lib/event");var d=f("../lib/useragent");var k=f("./default_handlers").DefaultHandlers;var b=f("./default_gutter_handler").GutterHandler;var j=f("./mouse_event").MouseEvent;var i=f("./dragdrop_handler").DragdropHandler;var e=f("../config");var g=function(m){this.editor=m;new k(this);new b(this);new i(this);var n=m.renderer.getMouseEventTarget();a.addListener(n,"click",this.onMouseEvent.bind(this,"click"));a.addListener(n,"mousemove",this.onMouseMove.bind(this,"mousemove"));a.addMultiMouseDownListener(n,[300,300,250],this,"onMouseEvent");if(m.renderer.scrollBarV){a.addMultiMouseDownListener(m.renderer.scrollBarV.inner,[300,300,250],this,"onMouseEvent");a.addMultiMouseDownListener(m.renderer.scrollBarH.inner,[300,300,250],this,"onMouseEvent")}a.addMouseWheelListener(m.container,this.onMouseWheel.bind(this,"mousewheel"));var l=m.renderer.$gutter;a.addListener(l,"mousedown",this.onMouseEvent.bind(this,"guttermousedown"));a.addListener(l,"click",this.onMouseEvent.bind(this,"gutterclick"));a.addListener(l,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick"));a.addListener(l,"mousemove",this.onMouseEvent.bind(this,"guttermousemove"));a.addListener(n,"mousedown",function(o){m.focus()});a.addListener(l,"mousedown",function(o){m.focus();return a.preventDefault(o)})};(function(){this.onMouseEvent=function(l,m){this.editor._emit(l,new j(m,this.editor))};this.onMouseMove=function(l,n){var m=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;if(!m||!m.length){return}this.editor._emit(l,new j(n,this.editor))};this.onMouseWheel=function(l,m){var n=new j(m,this.editor);n.speed=this.$scrollSpeed*2;n.wheelX=m.wheelX;n.wheelY=m.wheelY;this.editor._emit(l,n)};this.setState=function(l){this.state=l};this.captureMouse=function(p,m){this.x=p.x;this.y=p.y;this.isMousePressed=true;var q=this.editor.renderer;if(q.$keepTextAreaAtCursor){q.$keepTextAreaAtCursor=null}var n=this;var s=function(t){n.x=t.clientX;n.y=t.clientY;m&&m(t);n.mouseEvent=new j(t,n.editor);n.$mouseMoved=true};var r=function(t){clearInterval(l);o();n[n.state+"End"]&&n[n.state+"End"](t);n.$clickSelection=null;if(q.$keepTextAreaAtCursor==null){q.$keepTextAreaAtCursor=true;q.$moveTextAreaToCursor()}n.isMousePressed=false;n.$onCaptureMouseMove=n.releaseMouse=null;n.onMouseEvent("mouseup",t)};var o=function(){n[n.state]&&n[n.state]();n.$mouseMoved=false};if(d.isOldIE&&p.domEvent.type=="dblclick"){return setTimeout(function(){r(p)})}n.$onCaptureMouseMove=s;n.releaseMouse=a.capture(this.editor.container,s,r);var l=setInterval(o,20)};this.releaseMouse=null}).call(g.prototype);e.defineOptions(g.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:150},dragEnabled:{initialValue:true},focusTimout:{initialValue:0},tooltipFollowsMouse:{initialValue:true}});h.MouseHandler=g});