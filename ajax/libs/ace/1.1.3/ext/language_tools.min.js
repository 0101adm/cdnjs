define(function(f,g,b){var a=f("../snippets").snippetManager;var k=f("../autocomplete").Autocomplete;var e=f("../config");var o=f("../autocomplete/text_completer");var i={getCompletions:function(q,t,v,s,u){var r=q.session.getState(v.row);var p=t.$mode.getCompletions(r,t,v,s);u(null,p)}};var j={getCompletions:function(q,t,v,s,u){var r=a.snippetMap;var p=[];a.getActiveScopes(q).forEach(function(A){var y=r[A]||[];for(var x=y.length;x--;){var z=y[x];var w=z.name||z.tabTrigger;if(!w){continue}p.push({caption:w,snippet:z.content,meta:z.tabTrigger&&!z.name?z.tabTrigger+"\u21E5 ":"snippet"})}},this);u(null,p)}};var d=[j,o,i];g.addCompleter=function(p){d.push(p)};var m={name:"expandSnippet",exec:function(p){var q=a.expandWithTab(p);if(!q){p.execCommand("indent")}},bindKey:"tab"};var n=function(q,p){l(p.session.$mode)};var l=function(p){var q=p.$id;if(!a.files){a.files={}}c(q);if(p.modes){p.modes.forEach(l)}};var c=function(q){if(!q||a.files[q]){return}var p=q.replace("mode","snippets");a.files[q]={};e.loadModule(p,function(r){if(r){a.files[q]=r;r.snippets=a.parseSnippetFile(r.snippetText);a.register(r.snippets,r.scope);if(r.includeScopes){a.snippetMap[r.scope].includeScopes=r.includeScopes;r.includeScopes.forEach(function(s){c("ace/mode/"+s)})}}})};var h=f("../editor").Editor;f("../config").defineOptions(h.prototype,"editor",{enableBasicAutocompletion:{set:function(p){if(p){this.completers=d;this.commands.addCommand(k.startCommand)}else{this.commands.removeCommand(k.startCommand)}},value:false},enableSnippets:{set:function(p){if(p){this.commands.addCommand(m);this.on("changeMode",n);n(null,this)}else{this.commands.removeCommand(m);this.off("changeMode",n)}},value:false}})});