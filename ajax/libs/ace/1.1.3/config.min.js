define(function(e,h,d){var c=e("./lib/lang");var i=e("./lib/oop");var j=e("./lib/net");var m=e("./lib/event_emitter").EventEmitter;var b=(function(){return this})();var l={packaged:false,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};h.get=function(n){if(!l.hasOwnProperty(n)){throw new Error("Unknown config key: "+n)}return l[n]};h.set=function(n,o){if(!l.hasOwnProperty(n)){throw new Error("Unknown config key: "+n)}l[n]=o};h.all=function(){return c.copyObject(l)};i.implement(h,m);h.moduleUrl=function(p,o){if(l.$moduleUrls[p]){return l.$moduleUrls[p]}var t=p.split("/");o=o||t[t.length-2]||"";var n=o=="snippets"?"/":"-";var r=t[t.length-1];if(n=="-"){var q=new RegExp("^"+o+"[\\-_]|[\\-_]"+o+"$","g");r=r.replace(q,"")}if((!r||r==o)&&t.length>1){r=t[t.length-2]}var s=l[o+"Path"];if(s==null){s=l.basePath}else{if(n=="/"){o=n=""}}if(s&&s.slice(-1)!="/"){s+="/"}return s+o+n+r+this.get("suffix")};h.setModuleUrl=function(n,o){return l.$moduleUrls[n]=o};h.$loading={};h.loadModule=function(n,q){var o,p;if(Array.isArray(n)){p=n[0];n=n[1]}try{o=e(n)}catch(r){}if(o&&!h.$loading[n]){return q&&q(o)}if(!h.$loading[n]){h.$loading[n]=[]}h.$loading[n].push(q);if(h.$loading[n].length>1){return}var s=function(){e([n],function(t){h._emit("load.module",{name:n,module:t});var u=h.$loading[n];h.$loading[n]=null;u.forEach(function(v){v&&v(t)})})};if(!h.get("packaged")){return s()}j.loadScript(h.moduleUrl(n,p),s)};function k(p){l.packaged=p||e.packaged||d.packaged||(b.define&&define.packaged);if(!b.document){return""}var o={};var r="";var t=document.getElementsByTagName("script");for(var w=0;w<t.length;w++){var y=t[w];var n=y.src||y.getAttribute("src");if(!n){continue}var v=y.attributes;for(var u=0,s=v.length;u<s;u++){var x=v[u];if(x.name.indexOf("data-ace-")===0){o[f(x.name.replace(/^data-ace-/,""))]=x.value}}var q=n.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);if(q){r=q[1]}}if(r){o.base=o.base||r;o.packaged=true}o.basePath=o.base;o.workerPath=o.workerPath||o.base;o.modePath=o.modePath||o.base;o.themePath=o.themePath||o.base;delete o.base;for(var z in o){if(typeof o[z]!=="undefined"){h.set(z,o[z])}}}h.init=k;function f(n){return n.replace(/-(.)/g,function(o,p){return p.toUpperCase()})}var a={setOptions:function(n){Object.keys(n).forEach(function(o){this.setOption(o,n[o])},this)},getOptions:function(o){var n={};if(!o){o=Object.keys(this.$options)}else{if(!Array.isArray(o)){n=o;o=Object.keys(n)}}o.forEach(function(p){n[p]=this.getOption(p)},this);return n},setOption:function(n,p){if(this["$"+n]===p){return}var o=this.$options[n];if(!o){if(typeof console!="undefined"&&console.warn){console.warn('misspelled option "'+n+'"')}return undefined}if(o.forwardTo){return this[o.forwardTo]&&this[o.forwardTo].setOption(n,p)}if(!o.handlesSet){this["$"+n]=p}if(o&&o.set){o.set.call(this,p)}},getOption:function(n){var o=this.$options[n];if(!o){if(typeof console!="undefined"&&console.warn){console.warn('misspelled option "'+n+'"')}return undefined}if(o.forwardTo){return this[o.forwardTo]&&this[o.forwardTo].getOption(n)}return o&&o.get?o.get.call(this):this["$"+n]}};var g={};h.defineOptions=function(p,o,n){if(!p.$options){g[o]=p.$options={}}Object.keys(n).forEach(function(r){var q=n[r];if(typeof q=="string"){q={forwardTo:q}}q.name||(q.name=r);p.$options[q.name]=q;if("initialValue" in q){p["$"+q.name]=q.initialValue}});i.implement(p,a);return this};h.resetOptions=function(n){Object.keys(n.$options).forEach(function(p){var o=n.$options[p];if("value" in o){n.setOption(p,o.value)}})};h.setDefaultValue=function(q,n,p){var o=g[q]||(g[q]={});if(o[n]){if(o.forwardTo){h.setDefaultValue(o.forwardTo,n,p)}else{o[n].value=p}}};h.setDefaultValues=function(n,o){Object.keys(o).forEach(function(p){h.setDefaultValue(n,p,o[p])})}});