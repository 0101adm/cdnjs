define(function(b,a,c){var d=function(){this.reset()};(function(){this.execute=function(e){var f=e.args[0];this.$doc=e.args[1];if(e.merge&&this.hasUndo()){this.dirtyCounter--;f=this.$undoStack.pop().concat(f)}this.$undoStack.push(f);this.$redoStack=[];if(this.dirtyCounter<0){this.dirtyCounter=NaN}this.dirtyCounter++};this.undo=function(e){var g=this.$undoStack.pop();var f=null;if(g){f=this.$doc.undoChanges(g,e);this.$redoStack.push(g);this.dirtyCounter--}return f};this.redo=function(e){var g=this.$redoStack.pop();var f=null;if(g){f=this.$doc.redoChanges(g,e);this.$undoStack.push(g);this.dirtyCounter++}return f};this.reset=function(){this.$undoStack=[];this.$redoStack=[];this.dirtyCounter=0};this.hasUndo=function(){return this.$undoStack.length>0};this.hasRedo=function(){return this.$redoStack.length>0};this.markClean=function(){this.dirtyCounter=0};this.isClean=function(){return this.dirtyCounter===0}}).call(d.prototype);a.UndoManager=d});